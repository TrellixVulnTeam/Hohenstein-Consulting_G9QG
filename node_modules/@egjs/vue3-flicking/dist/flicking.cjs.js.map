{"version":3,"file":"flicking.cjs.js","sources":["../src/FlickingProps.ts","../src/VueRenderer.ts","../src/VuePanel.ts","../src/VueElementProvider.ts","../src/Flicking.ts"],"sourcesContent":["/*\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n/* eslint-disable @typescript-eslint/explicit-member-accessibility */\nimport { prop } from \"vue-class-component\";\nimport {\n  FlickingOptions,\n  Plugin,\n  Status\n} from \"@egjs/flicking\";\n\nclass FlickingProps {\n  viewportTag = prop<string>({ required: false, default: \"div\" });\n  cameraTag = prop<string>({ required: false, default: \"div\" });\n  hideBeforeInit = prop<boolean>({ required: false, default: false });\n  firstPanelSize = prop<string>({ required: false });\n  options = prop<Partial<FlickingOptions>>({ required: false, default: {} });\n  plugins = prop<Plugin[]>({ required: false, default: [] });\n  status = prop<Status>({ required: false });\n}\n\nexport default FlickingProps;\n","/*\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport {\n  ExternalRenderer,\n  getFlickingAttached,\n  PanelOptions,\n  RendererOptions\n} from \"@egjs/flicking\";\n\nimport VueFlicking from \"./Flicking\";\nimport VuePanel from \"./VuePanel\";\n\nexport interface VueRendererOptions extends RendererOptions {\n  vueFlicking: VueFlicking;\n}\n\nclass VueRenderer extends ExternalRenderer {\n  // Internal States\n  private _vueFlicking: VueFlicking;\n\n  public constructor(options: VueRendererOptions) {\n    super(options);\n\n    this._vueFlicking = options.vueFlicking;\n  }\n\n  public async render() {\n    const flicking = getFlickingAttached(this._flicking);\n    const vueFlicking = this._vueFlicking;\n    const strategy = this._strategy;\n\n    strategy.updateRenderingPanels(flicking);\n    strategy.renderPanels(flicking);\n\n    return new Promise<void>((resolve) => {\n      vueFlicking.renderEmitter.once(\"render\", resolve);\n      vueFlicking.$forceUpdate();\n    });\n  }\n\n  public async forceRenderAllPanels() {\n    const vueFlicking = this._vueFlicking;\n\n    await super.forceRenderAllPanels();\n\n    return new Promise<void>((resolve) => {\n      vueFlicking.renderEmitter.once(\"render\", resolve);\n      vueFlicking.$forceUpdate();\n    });\n  }\n\n  protected _collectPanels() {\n    const flicking = getFlickingAttached(this._flicking);\n    const vueFlicking = this._vueFlicking;\n    const childRefs = vueFlicking.$refs;\n    const vuePanels: any[] = Object.keys(childRefs).map(refKey => childRefs[refKey]);\n\n    this._panels = this._strategy.collectPanels(flicking, vuePanels);\n  }\n\n  protected _createPanel(externalComponent: VuePanel, options: PanelOptions) {\n    return this._strategy.createPanel(externalComponent, options);\n  }\n}\n\nexport default VueRenderer;\n","/*\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { Vue } from \"vue-class-component\";\n\nclass VuePanel extends Vue {\n  public hide: boolean = false;\n\n  public get nativeElement() { return this.$.subTree.children![0].el as HTMLElement; }\n\n  public render() {\n    if (this.hide || !this.$slots.default) return;\n\n    return this.$slots.default() as any;\n  }\n}\n\nexport default VuePanel;\n","/*\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { ExternalElementProvider } from \"@egjs/flicking\";\n\nimport VuePanel from \"./VuePanel\";\n\nclass VueElementProvider implements ExternalElementProvider {\n  private _el: VuePanel;\n\n  public get element() { return this._el.nativeElement; }\n  public get rendered() { return !this._el.hide; }\n\n  public constructor(el: VuePanel) {\n    this._el = el;\n  }\n\n  public show() {\n    this._el.hide = false;\n  }\n\n  public hide() {\n    this._el.hide = true;\n  }\n}\n\nexport default VueElementProvider;\n","/*\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n/* eslint-disable @typescript-eslint/explicit-member-accessibility */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { h, VNode, resolveComponent, Fragment, getCurrentInstance } from \"vue\";\nimport { Vue, Options, VueConstructor } from \"vue-class-component\";\nimport ListDiffer, { DiffResult } from \"@egjs/list-differ\";\nimport Component from \"@egjs/component\";\nimport VanillaFlicking, {\n  EVENTS,\n  withFlickingMethods,\n  sync,\n  Plugin,\n  getRenderingPanels,\n  getDefaultCameraTransform,\n  range,\n  VirtualRenderingStrategy,\n  NormalRenderingStrategy,\n  ExternalPanel\n} from \"@egjs/flicking\";\n\nimport FlickingProps from \"./FlickingProps\";\nimport VueRenderer, { VueRendererOptions } from \"./VueRenderer\";\nimport VuePanel from \"./VuePanel\";\nimport VueElementProvider from \"./VueElementProvider\";\n\n@Options({\n  components: {\n    Panel: VuePanel\n  }\n})\nclass Flicking extends Vue.with(FlickingProps) {\n  public readonly renderEmitter = new Component<{ render: void }>();\n\n  @withFlickingMethods private vanillaFlicking: VanillaFlicking | null = null;\n  private pluginsDiffer!: ListDiffer<Plugin>;\n  private slotDiffer!: ListDiffer<VNode>;\n  private diffResult?: DiffResult<VNode> = undefined;\n\n  public mounted() {\n    const options = this.options;\n    const viewportEl = this.$el as HTMLElement;\n    const rendererOptions: VueRendererOptions = {\n      vueFlicking: this,\n      strategy: options.virtual && (options.panelsPerView ?? -1) > 0\n        ? new VirtualRenderingStrategy()\n        : new NormalRenderingStrategy({\n          providerCtor: VueElementProvider,\n          panelCtor: ExternalPanel\n        })\n    };\n\n    const flicking = new VanillaFlicking(viewportEl, {\n      ...this.options,\n      ...{ renderExternal: {\n        renderer: VueRenderer,\n        rendererOptions\n      }}\n    });\n    this.vanillaFlicking = flicking;\n\n    flicking.once(EVENTS.READY, () => {\n      this.$forceUpdate();\n    });\n\n    const slots = this.getSlots();\n    this.slotDiffer = new ListDiffer<VNode>(slots, vnode => vnode.key! as string | number);\n    this.pluginsDiffer = new ListDiffer<Plugin>();\n\n    this.bindEvents();\n    this.checkPlugins();\n\n    if (this.status) {\n      flicking.setStatus(this.status);\n    }\n  }\n\n  public beforeDestroy() {\n    this.vanillaFlicking?.destroy();\n  }\n\n  public beforeMount() {\n    this.fillKeys();\n  }\n\n  public beforeUpdate() {\n    this.fillKeys();\n\n    this.diffResult = this.slotDiffer.update(this.getSlots());\n  }\n\n  public updated() {\n    const flicking = this.vanillaFlicking;\n    const diffResult = this.diffResult;\n\n    this.checkPlugins();\n    this.renderEmitter.trigger(\"render\");\n\n    if (!diffResult || !flicking?.initialized) return;\n\n    const children = this.getChildren();\n\n    sync(flicking, diffResult, children);\n\n    if (diffResult.added.length > 0 || diffResult.removed.length > 0) {\n      this.$forceUpdate();\n    }\n\n    this.diffResult = undefined;\n  }\n\n  public render() {\n    const flicking = this.vanillaFlicking;\n    const options = this.options;\n    const initialized = flicking && flicking.initialized;\n    const isHorizontal = flicking\n      ? flicking.horizontal\n      : this.options.horizontal ?? true;\n\n    const viewportData = {\n      class: {\n        \"flicking-viewport\": true,\n        \"vertical\": !isHorizontal,\n        \"flicking-hidden\": this.hideBeforeInit && !initialized\n      }\n    };\n    const cameraData = {\n      class: {\n        \"flicking-camera\": true\n      },\n      style: !initialized && this.firstPanelSize\n        ? { transform: getDefaultCameraTransform(this.options.align, this.options.horizontal, this.firstPanelSize) }\n        : {}\n    };\n\n    const panels = options.virtual && options.panelsPerView && options.panelsPerView > 0\n      ? this.getVirtualPanels\n      : this.getPanels;\n\n    const viewportSlots = this.$slots.viewport\n      ? this.$slots.viewport()\n      : [];\n\n    return h(this.viewportTag, viewportData,\n      [h(this.cameraTag, cameraData, { default: panels }), ...viewportSlots]\n    );\n  }\n\n  public getSlots() {\n    const slots = this.$slots.default\n      ? this.$slots.default()\n      : [];\n\n    return slots.reduce((elementSlots, slot) => [...elementSlots, ...this.getElementVNodes(slot)], [] as VNode[]);\n  }\n\n  public getElementVNodes(slot: VNode, childSlots: VNode[] = []): VNode[] {\n    if (slot.type === Fragment && Array.isArray(slot.children)) {\n      slot.children\n        .filter(child => child && typeof child === \"object\")\n        .forEach(child => this.getElementVNodes(child as VNode, childSlots));\n    } else {\n      childSlots.push(slot);\n    }\n\n    return childSlots;\n  }\n\n  private bindEvents() {\n    const flicking = this.vanillaFlicking;\n    const events = (Object.keys(EVENTS) as Array<keyof typeof EVENTS>)\n      .map(key => EVENTS[key]);\n\n    events.forEach(eventName => {\n      flicking!.on(eventName, (e: any) => {\n        e.currentTarget = this;\n        // Make events from camelCase to kebab-case\n        this.$emit(eventName.replace(/([A-Z])/g, \"-$1\").toLowerCase(), e);\n      });\n    });\n  }\n\n  private checkPlugins() {\n    const { list, added, removed, prevList } = this.pluginsDiffer.update(this.plugins);\n\n    this.vanillaFlicking!.addPlugins(...added.map(index => list[index]));\n    this.vanillaFlicking!.removePlugins(...removed.map(index => prevList[index]));\n  }\n\n  private fillKeys() {\n    const vnodes = this.getSlots();\n\n    vnodes.forEach((node, idx) => {\n      if (node.key == null) {\n        node.key = `$_${idx}`;\n      }\n    });\n  }\n\n  private getChildren() {\n    const childRefs = this.$refs;\n\n    return Object.keys(childRefs).map(refKey => childRefs[refKey]);\n  }\n\n  private getPanels = () => {\n    const componentInstance = getCurrentInstance() as unknown as { ctx: Flicking } | null;\n    const vueFlicking = componentInstance?.ctx;\n    const flicking = this.vanillaFlicking;\n    const defaultSlots = this.getSlots();\n    const diffResult = vueFlicking?.diffResult;\n\n    const slots = diffResult\n      ? getRenderingPanels(flicking!, diffResult)\n      : defaultSlots;\n\n    const panelComponent = resolveComponent(\"Panel\");\n    const panels = slots.map((slot, idx) => h(panelComponent as any, {\n      key: slot.key!,\n      ref: idx.toString()\n    }, () => slot));\n\n    return panels;\n  };\n\n  private getVirtualPanels = () => {\n    const options = this.options;\n    const {\n      panelClass = \"flicking-panel\"\n    } = options.virtual!;\n    const panelsPerView = options.panelsPerView!;\n    const flicking = this.vanillaFlicking;\n    const initialized = flicking && flicking.initialized;\n\n    const renderingIndexes = initialized\n      ? flicking.renderer.strategy.getRenderingIndexesByOrder(flicking)\n      : range(panelsPerView + 1);\n\n    const firstPanel = initialized && flicking.panels[0];\n    const size = firstPanel\n      ? flicking.horizontal\n        ? { width: firstPanel.size }\n        : { height: firstPanel.size }\n      : {};\n\n    return renderingIndexes.map(idx => h(\"div\", {\n      key: idx,\n      ref: idx.toString(),\n      class: panelClass,\n      style: size,\n      domProps: {\n        \"data-element-index\": idx\n      }\n    }));\n  };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface Flicking extends VanillaFlicking, VueConstructor<Vue & FlickingProps> {}\nexport default Flicking;\n"],"names":["prop","required","default","__extends","options","_super","_this","_vueFlicking","vueFlicking","flicking","getFlickingAttached","_flicking","strategy","_strategy","updateRenderingPanels","renderPanels","Promise","resolve","renderEmitter","once","$forceUpdate","forceRenderAllPanels","_a","childRefs","$refs","vuePanels","Object","keys","map","refKey","_panels","collectPanels","externalComponent","createPanel","ExternalRenderer","$","subTree","children","el","hide","$slots","Vue","_el","nativeElement","Component","undefined","componentInstance","getCurrentInstance","ctx","vanillaFlicking","defaultSlots","getSlots","diffResult","slots","getRenderingPanels","panelComponent","resolveComponent","panels","slot","idx","h","key","ref","toString","virtual","panelClass","panelsPerView","initialized","renderingIndexes","renderer","getRenderingIndexesByOrder","range","firstPanel","size","horizontal","width","height","class","style","domProps","viewportEl","$el","rendererOptions","VirtualRenderingStrategy","NormalRenderingStrategy","providerCtor","VueElementProvider","panelCtor","ExternalPanel","VanillaFlicking","renderExternal","VueRenderer","EVENTS","READY","slotDiffer","ListDiffer","vnode","pluginsDiffer","bindEvents","checkPlugins","status","setStatus","destroy","fillKeys","update","trigger","getChildren","sync","added","length","removed","isHorizontal","viewportData","hideBeforeInit","cameraData","firstPanelSize","transform","getDefaultCameraTransform","align","getVirtualPanels","getPanels","viewportSlots","viewport","viewportTag","cameraTag","reduce","elementSlots","getElementVNodes","childSlots","type","Fragment","Array","isArray","filter","child","forEach","push","events","eventName","on","e","currentTarget","$emit","replace","toLowerCase","_c","plugins","list","prevList","addPlugins","index","_b","removePlugins","vnodes","node","__decorate","withFlickingMethods","Flicking","Options","components","Panel","VuePanel","with","FlickingProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;AAYA;;;AAAA,wBAAA;AACE,oBAAA,GAAcA,sBAAI,CAAS;AAAEC,MAAAA,QAAQ,EAAE,KAAZ;AAAmBC,MAAAA,OAAO,EAAE;AAA5B,KAAT,CAAlB;AACA,kBAAA,GAAYF,sBAAI,CAAS;AAAEC,MAAAA,QAAQ,EAAE,KAAZ;AAAmBC,MAAAA,OAAO,EAAE;AAA5B,KAAT,CAAhB;AACA,uBAAA,GAAiBF,sBAAI,CAAU;AAAEC,MAAAA,QAAQ,EAAE,KAAZ;AAAmBC,MAAAA,OAAO,EAAE;AAA5B,KAAV,CAArB;AACA,uBAAA,GAAiBF,sBAAI,CAAS;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAT,CAArB;AACA,gBAAA,GAAUD,sBAAI,CAA2B;AAAEC,MAAAA,QAAQ,EAAE,KAAZ;AAAmBC,MAAAA,OAAO,EAAE;AAA5B,KAA3B,CAAd;AACA,gBAAA,GAAUF,sBAAI,CAAW;AAAEC,MAAAA,QAAQ,EAAE,KAAZ;AAAmBC,MAAAA,OAAO,EAAE;AAA5B,KAAX,CAAd;AACA,eAAA,GAASF,sBAAI,CAAS;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAT,CAAb;AACD;;AAAD,sBAAA;AAAC,GARD;;ACMA;;;AAA0BE,EAAAA,8BAAA;;AAIxB,sBAAA,CAAmBC,OAAnB;AAAA,gBACEC,WAAA,KAAA,EAAMD,OAAN,SADF;;AAGEE,IAAAA,KAAI,CAACC,YAAL,GAAoBH,OAAO,CAACI,WAA5B;;AACD;;;;AAEY,gBAAA,GAAb;;;;AACQC,QAAAA,QAAQ,GAAGC,mCAAmB,CAAC,KAAKC,SAAN,CAA9B;AACAH,QAAAA,WAAW,GAAG,KAAKD,YAAnB;AACAK,QAAAA,QAAQ,GAAG,KAAKC,SAAhB;AAEND,QAAAA,QAAQ,CAACE,qBAAT,CAA+BL,QAA/B;AACAG,QAAAA,QAAQ,CAACG,YAAT,CAAsBN,QAAtB;AAEA;;UAAO,IAAIO,OAAJ,CAAkB,UAACC,OAAD;AACvBT,UAAAA,WAAW,CAACU,aAAZ,CAA0BC,IAA1B,CAA+B,QAA/B,EAAyCF,OAAzC;AACAT,UAAAA,WAAW,CAACY,YAAZ;AACD,SAHM,EAAP;;;AAID,GAZY;;AAcA,8BAAA,GAAb;;;;;;AACQZ,YAAAA,WAAW,GAAG,KAAKD,YAAnB;AAEN;;cAAMF,gBAAA,CAAMgB,oBAAN,KAAA,KAAA,EAAN;;;AAAAC,YAAAA,OAAA;;AAEA;;cAAO,IAAIN,OAAJ,CAAkB,UAACC,OAAD;AACvBT,cAAAA,WAAW,CAACU,aAAZ,CAA0BC,IAA1B,CAA+B,QAA/B,EAAyCF,OAAzC;AACAT,cAAAA,WAAW,CAACY,YAAZ;AACD,aAHM,EAAP;;;;AAID,GATY;;AAWH,wBAAA,GAAV;AACE,QAAMX,QAAQ,GAAGC,mCAAmB,CAAC,KAAKC,SAAN,CAApC;AACA,QAAMH,WAAW,GAAG,KAAKD,YAAzB;AACA,QAAMgB,SAAS,GAAGf,WAAW,CAACgB,KAA9B;AACA,QAAMC,SAAS,GAAUC,MAAM,CAACC,IAAP,CAAYJ,SAAZ,EAAuBK,GAAvB,CAA2B,UAAAC,MAAA;AAAU,aAAAN,SAAS,CAACM,MAAD,CAAT;AAAiB,KAAtD,CAAzB;AAEA,SAAKC,OAAL,GAAe,KAAKjB,SAAL,CAAekB,aAAf,CAA6BtB,QAA7B,EAAuCgB,SAAvC,CAAf;AACD,GAPS;;AASA,sBAAA,GAAV,UAAuBO,iBAAvB,EAAoD5B,OAApD;AACE,WAAO,KAAKS,SAAL,CAAeoB,WAAf,CAA2BD,iBAA3B,EAA8C5B,OAA9C,CAAP;AACD,GAFS;;AAGZ,oBAAA;AA/CA,EAA0B8B,iCAA1B;;ACZA;;;AAAuB/B,EAAAA,2BAAA;;AAAvB,mBAAA;AAAA,wEAAA;;AACSG,IAAAA,UAAA,GAAgB,KAAhB;;AASR;;;AAPCoB,EAAAA,qBAAA,yBAAA;SAAA;AAA6B,aAAO,KAAKS,CAAL,CAAOC,OAAP,CAAeC,QAAf,CAAyB,CAAzB,EAA4BC,EAAnC;AAAuD;;;GAApF;;AAEO,gBAAA,GAAP;AACE,QAAI,KAAKC,IAAL,IAAa,CAAC,KAAKC,MAAL,CAAYtC,OAA9B,EAAuC;AAEvC,WAAO,KAAKsC,MAAL,CAAYtC,OAAZ,EAAP;AACD,GAJM;;AAKT,iBAAA;AAVA,EAAuBuC,sBAAvB;;ACEA;;;AAME,6BAAA,CAAmBH,EAAnB;AACE,SAAKI,GAAL,GAAWJ,EAAX;AACD;;;AALDZ,EAAAA,qBAAA,mBAAA;SAAA;AAAuB,aAAO,KAAKgB,GAAL,CAASC,aAAhB;AAAgC;;;GAAvD;AACAjB,EAAAA,qBAAA,oBAAA;SAAA;AAAwB,aAAO,CAAC,KAAKgB,GAAL,CAASH,IAAjB;AAAwB;;;GAAhD;;AAMO,cAAA,GAAP;AACE,SAAKG,GAAL,CAASH,IAAT,GAAgB,KAAhB;AACD,GAFM;;AAIA,cAAA,GAAP;AACE,SAAKG,GAAL,CAASH,IAAT,GAAgB,IAAhB;AACD,GAFM;;AAGT,2BAAA;AAAC,GAjBD;;;;;ACyBuBpC,EAAAA,2BAAA;;AAAvB,mBAAA;AAAA,wEAAA;;AACkBG,IAAAA,mBAAA,GAAgB,IAAIsC,SAAJ,EAAhB;AAEatC,IAAAA,qBAAA,GAA0C,IAA1C;AAGrBA,IAAAA,gBAAA,GAAiCuC,SAAjC;;AAwKAvC,IAAAA,eAAA,GAAY;AAClB,UAAMwC,iBAAiB,GAAGC,sBAAkB,EAA5C;AACA,UAAMvC,WAAW,GAAGsC,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,SAAA,GAAAA,iBAAiB,CAAEE,GAAvC;AACA,UAAMvC,QAAQ,GAAGH,KAAI,CAAC2C,eAAtB;;AACA,UAAMC,YAAY,GAAG5C,KAAI,CAAC6C,QAAL,EAArB;;AACA,UAAMC,UAAU,GAAG5C,WAAW,SAAX,IAAAA,WAAW,WAAX,SAAA,GAAAA,WAAW,CAAE4C,UAAhC;AAEA,UAAMC,KAAK,GAAGD,UAAU,GACpBE,kCAAkB,CAAC7C,QAAD,EAAY2C,UAAZ,CADE,GAEpBF,YAFJ;AAIA,UAAMK,cAAc,GAAGC,oBAAgB,CAAC,OAAD,CAAvC;AACA,UAAMC,MAAM,GAAGJ,KAAK,CAACzB,GAAN,CAAU,UAAC8B,IAAD,EAAOC,GAAP;AAAe,eAAAC,KAAC,CAACL,cAAD,EAAwB;AAC/DM,UAAAA,GAAG,EAAEH,IAAI,CAACG,GADqD;AAE/DC,UAAAA,GAAG,EAAEH,GAAG,CAACI,QAAJ;AAF0D,SAAxB,EAGtC;AAAM,iBAAAL,IAAA;AAAI,SAH4B,CAAD;AAG1B,OAHC,CAAf;AAKA,aAAOD,MAAP;AACD,KAlBO;;AAoBAnD,IAAAA,sBAAA,GAAmB;AACzB,UAAMF,OAAO,GAAGE,KAAI,CAACF,OAArB;AAEE,UAAAkB,KACElB,OAAO,CAAC4D,OAAR,WADF;AAAA,UAAAC,UAAU,mBAAG,qBAAb;AAEF,UAAMC,aAAa,GAAG9D,OAAO,CAAC8D,aAA9B;AACA,UAAMzD,QAAQ,GAAGH,KAAI,CAAC2C,eAAtB;AACA,UAAMkB,WAAW,GAAG1D,QAAQ,IAAIA,QAAQ,CAAC0D,WAAzC;AAEA,UAAMC,gBAAgB,GAAGD,WAAW,GAChC1D,QAAQ,CAAC4D,QAAT,CAAkBzD,QAAlB,CAA2B0D,0BAA3B,CAAsD7D,QAAtD,CADgC,GAEhC8D,qBAAK,CAACL,aAAa,GAAG,CAAjB,CAFT;AAIA,UAAMM,UAAU,GAAGL,WAAW,IAAI1D,QAAQ,CAACgD,MAAT,CAAgB,CAAhB,CAAlC;AACA,UAAMgB,IAAI,GAAGD,UAAU,GACnB/D,QAAQ,CAACiE,UAAT,GACE;AAAEC,QAAAA,KAAK,EAAEH,UAAU,CAACC;AAApB,OADF,GAEE;AAAEG,QAAAA,MAAM,EAAEJ,UAAU,CAACC;AAArB,OAHiB,GAInB,EAJJ;AAMA,aAAOL,gBAAgB,CAACxC,GAAjB,CAAqB,UAAA+B,GAAA;AAAO,eAAAC,KAAC,CAAC,KAAD,EAAQ;AAC1CC,UAAAA,GAAG,EAAEF,GADqC;AAE1CG,UAAAA,GAAG,EAAEH,GAAG,CAACI,QAAJ,EAFqC;AAG1Cc,UAAAA,KAAK,EAAEZ,UAHmC;AAI1Ca,UAAAA,KAAK,EAAEL,IAJmC;AAK1CM,UAAAA,QAAQ,EAAE;AACR,kCAAsBpB;AADd;AALgC,SAAR,CAAD;AAQjC,OARK,CAAP;AASD,KA7BO;;;AA8BT;;;;AAxNQ,iBAAA,GAAP;AAAA,oBAAA;;;;AACE,QAAMvD,OAAO,GAAG,KAAKA,OAArB;AACA,QAAM4E,UAAU,GAAG,KAAKC,GAAxB;AACA,QAAMC,eAAe,GAAuB;AAC1C1E,MAAAA,WAAW,EAAE,IAD6B;AAE1CI,MAAAA,QAAQ,EAAER,OAAO,CAAC4D,OAAR,IAAmB,CAAC,MAAA5D,OAAO,CAAC8D,aAAR,UAAA,iBAAA,KAAA,GAAyB,CAAC,CAA3B,IAAgC,CAAnD,GACN,IAAIiB,wCAAJ,EADM,GAEN,IAAIC,uCAAJ,CAA4B;AAC5BC,QAAAA,YAAY,EAAEC,kBADc;AAE5BC,QAAAA,SAAS,EAAEC;AAFiB,OAA5B;AAJsC,KAA5C;AAUA,QAAM/E,QAAQ,GAAG,IAAIgF,eAAJ,CAAoBT,UAApB,wBACZ,KAAK5E,UACL;AAAEsF,MAAAA,cAAc,EAAE;AACnBrB,QAAAA,QAAQ,EAAEsB,WADS;AAEnBT,QAAAA,eAAe;AAFI;AAAlB,MAFY,CAAjB;AAOA,SAAKjC,eAAL,GAAuBxC,QAAvB;AAEAA,IAAAA,QAAQ,CAACU,IAAT,CAAcyE,sBAAM,CAACC,KAArB,EAA4B;AAC1BvF,MAAAA,KAAI,CAACc,YAAL;AACD,KAFD;AAIA,QAAMiC,KAAK,GAAG,KAAKF,QAAL,EAAd;AACA,SAAK2C,UAAL,GAAkB,IAAIC,UAAJ,CAAsB1C,KAAtB,EAA6B,UAAA2C,KAAA;AAAS,aAAAA,KAAK,CAACnC,GAAN;AAA6B,KAAnE,CAAlB;AACA,SAAKoC,aAAL,GAAqB,IAAIF,UAAJ,EAArB;AAEA,SAAKG,UAAL;AACA,SAAKC,YAAL;;AAEA,QAAI,KAAKC,MAAT,EAAiB;AACf3F,MAAAA,QAAQ,CAAC4F,SAAT,CAAmB,KAAKD,MAAxB;AACD;AACF,GApCM;;AAsCA,uBAAA,GAAP;;;AACE,UAAA,KAAKnD,eAAL,UAAA,iBAAA,SAAA,MAAsBqD,SAAtB;AACD,GAFM;;AAIA,qBAAA,GAAP;AACE,SAAKC,QAAL;AACD,GAFM;;AAIA,sBAAA,GAAP;AACE,SAAKA,QAAL;AAEA,SAAKnD,UAAL,GAAkB,KAAK0C,UAAL,CAAgBU,MAAhB,CAAuB,KAAKrD,QAAL,EAAvB,CAAlB;AACD,GAJM;;AAMA,iBAAA,GAAP;AACE,QAAM1C,QAAQ,GAAG,KAAKwC,eAAtB;AACA,QAAMG,UAAU,GAAG,KAAKA,UAAxB;AAEA,SAAK+C,YAAL;AACA,SAAKjF,aAAL,CAAmBuF,OAAnB,CAA2B,QAA3B;AAEA,QAAI,CAACrD,UAAD,IAAe,EAAC3C,QAAQ,SAAR,IAAAA,QAAQ,WAAR,SAAA,GAAAA,QAAQ,CAAE0D,WAAX,CAAnB,EAA2C;AAE3C,QAAM9B,QAAQ,GAAG,KAAKqE,WAAL,EAAjB;AAEAC,IAAAA,oBAAI,CAAClG,QAAD,EAAW2C,UAAX,EAAuBf,QAAvB,CAAJ;;AAEA,QAAIe,UAAU,CAACwD,KAAX,CAAiBC,MAAjB,GAA0B,CAA1B,IAA+BzD,UAAU,CAAC0D,OAAX,CAAmBD,MAAnB,GAA4B,CAA/D,EAAkE;AAChE,WAAKzF,YAAL;AACD;;AAED,SAAKgC,UAAL,GAAkBP,SAAlB;AACD,GAlBM;;AAoBA,gBAAA,GAAP;;;AACE,QAAMpC,QAAQ,GAAG,KAAKwC,eAAtB;AACA,QAAM7C,OAAO,GAAG,KAAKA,OAArB;AACA,QAAM+D,WAAW,GAAG1D,QAAQ,IAAIA,QAAQ,CAAC0D,WAAzC;AACA,QAAM4C,YAAY,GAAGtG,QAAQ,GACzBA,QAAQ,CAACiE,UADgB,GAEzB,MAAA,KAAKtE,OAAL,CAAasE,UAAb,UAAA,iBAAA,KAAA,GAA2B,IAF/B;AAIA,QAAMsC,YAAY,GAAG;AACnBnC,MAAAA,KAAK,EAAE;AACL,6BAAqB,IADhB;AAEL,oBAAY,CAACkC,YAFR;AAGL,2BAAmB,KAAKE,cAAL,IAAuB,CAAC9C;AAHtC;AADY,KAArB;AAOA,QAAM+C,UAAU,GAAG;AACjBrC,MAAAA,KAAK,EAAE;AACL,2BAAmB;AADd,OADU;AAIjBC,MAAAA,KAAK,EAAE,CAACX,WAAD,IAAgB,KAAKgD,cAArB,GACH;AAAEC,QAAAA,SAAS,EAAEC,yCAAyB,CAAC,KAAKjH,OAAL,CAAakH,KAAd,EAAqB,KAAKlH,OAAL,CAAasE,UAAlC,EAA8C,KAAKyC,cAAnD;AAAtC,OADG,GAEH;AANa,KAAnB;AASA,QAAM1D,MAAM,GAAGrD,OAAO,CAAC4D,OAAR,IAAmB5D,OAAO,CAAC8D,aAA3B,IAA4C9D,OAAO,CAAC8D,aAAR,GAAwB,CAApE,GACX,KAAKqD,gBADM,GAEX,KAAKC,SAFT;AAIA,QAAMC,aAAa,GAAG,KAAKjF,MAAL,CAAYkF,QAAZ,GAClB,KAAKlF,MAAL,CAAYkF,QAAZ,EADkB,GAElB,EAFJ;AAIA,WAAO9D,KAAC,CAAC,KAAK+D,WAAN,EAAmBX,YAAnB,iBACLpD,KAAC,CAAC,KAAKgE,SAAN,EAAiBV,UAAjB,EAA6B;AAAEhH,MAAAA,OAAO,EAAEuD;AAAX,KAA7B,IAAsDgE,oBADlD,CAAR;AAGD,GAnCM;;AAqCA,kBAAA,GAAP;AAAA,oBAAA;;AACE,QAAMpE,KAAK,GAAG,KAAKb,MAAL,CAAYtC,OAAZ,GACV,KAAKsC,MAAL,CAAYtC,OAAZ,EADU,GAEV,EAFJ;AAIA,WAAOmD,KAAK,CAACwE,MAAN,CAAa,UAACC,YAAD,EAAepE,IAAf;AAAwB,6CAAIoE,qBAAiBxH,KAAI,CAACyH,gBAAL,CAAsBrE,IAAtB,QAArB;AAAiD,KAAtF,EAAwF,EAAxF,CAAP;AACD,GANM;;AAQA,0BAAA,GAAP,UAAwBA,IAAxB,EAAqCsE,UAArC;AAAA,oBAAA;;AAAqC,6BAAA,EAAA;AAAAA,MAAAA,eAAA;;;AACnC,QAAItE,IAAI,CAACuE,IAAL,KAAcC,YAAd,IAA0BC,KAAK,CAACC,OAAN,CAAc1E,IAAI,CAACrB,QAAnB,CAA9B,EAA4D;AAC1DqB,MAAAA,IAAI,CAACrB,QAAL,CACGgG,MADH,CACU,UAAAC,KAAA;AAAS,eAAAA,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA1B;AAAkC,OADrD,EAEGC,OAFH,CAEW,UAAAD,KAAA;AAAS,eAAAhI,KAAI,CAACyH,gBAAL,CAAsBO,KAAtB,EAAsCN,UAAtC,CAAA;AAAiD,OAFrE;AAGD,KAJD,MAIO;AACLA,MAAAA,UAAU,CAACQ,IAAX,CAAgB9E,IAAhB;AACD;;AAED,WAAOsE,UAAP;AACD,GAVM;;AAYC,oBAAA,GAAR;AAAA,oBAAA;;AACE,QAAMvH,QAAQ,GAAG,KAAKwC,eAAtB;AACA,QAAMwF,MAAM,GAAI/G,MAAM,CAACC,IAAP,CAAYiE,sBAAZ,EACbhE,GADa,CACT,UAAAiC,GAAA;AAAO,aAAA+B,sBAAM,CAAC/B,GAAD,CAAN;AAAW,KADT,CAAhB;AAGA4E,IAAAA,MAAM,CAACF,OAAP,CAAe,UAAAG,SAAA;AACbjI,MAAAA,QAAS,CAACkI,EAAV,CAAaD,SAAb,EAAwB,UAACE,CAAD;AACtBA,QAAAA,CAAC,CAACC,aAAF,GAAkBvI,KAAlB;;AAEAA,QAAAA,KAAI,CAACwI,KAAL,CAAWJ,SAAS,CAACK,OAAV,CAAkB,UAAlB,EAA8B,KAA9B,EAAqCC,WAArC,EAAX,EAA+DJ,CAA/D;AACD,OAJD;AAKD,KAND;AAOD,GAZO;;AAcA,sBAAA,GAAR;;;AACQ,QAAAK,KAAqC,KAAKhD,aAAL,CAAmBO,MAAnB,CAA0B,KAAK0C,OAA/B,CAArC;AAAA,QAAEC,IAAI,UAAN;AAAA,QAAQvC,KAAK,WAAb;AAAA,QAAeE,OAAO,aAAtB;AAAA,QAAwBsC,QAAQ,cAAhC;;AAEN,KAAA9H,KAAA,KAAK2B,eAAL,EAAsBoG,UAAtB,MAAA,GAAA,EAAoCzC,KAAK,CAAChF,GAAN,CAAU,UAAA0H,KAAA;AAAS,aAAAH,IAAI,CAACG,KAAD,CAAJ;AAAW,KAA9B,CAApC;;AACA,KAAAC,KAAA,KAAKtG,eAAL,EAAsBuG,aAAtB,MAAA,GAAA,EAAuC1C,OAAO,CAAClF,GAAR,CAAY,UAAA0H,KAAA;AAAS,aAAAF,QAAQ,CAACE,KAAD,CAAR;AAAe,KAApC,CAAvC;AACD,GALO;;AAOA,kBAAA,GAAR;AACE,QAAMG,MAAM,GAAG,KAAKtG,QAAL,EAAf;AAEAsG,IAAAA,MAAM,CAAClB,OAAP,CAAe,UAACmB,IAAD,EAAO/F,GAAP;AACb,UAAI+F,IAAI,CAAC7F,GAAL,IAAY,IAAhB,EAAsB;AACpB6F,QAAAA,IAAI,CAAC7F,GAAL,GAAW,OAAKF,GAAhB;AACD;AACF,KAJD;AAKD,GARO;;AAUA,qBAAA,GAAR;AACE,QAAMpC,SAAS,GAAG,KAAKC,KAAvB;AAEA,WAAOE,MAAM,CAACC,IAAP,CAAYJ,SAAZ,EAAuBK,GAAvB,CAA2B,UAAAC,MAAA;AAAU,aAAAN,SAAS,CAACM,MAAD,CAAT;AAAiB,KAAtD,CAAP;AACD,GAJO;;AArKa8H,EAAAA,YAApBC,oFAAoB;;AAHjBC,EAAAA,QAAQ,eALbC,yBAAO,CAAC;AACPC,IAAAA,UAAU,EAAE;AACVC,MAAAA,KAAK,EAAEC;AADG;AADL,GAAD,IAKFJ,SAAA;AAgON,iBAAA;AAhOA,EAAuBpH,qBAAG,CAACyH,IAAJ,CAASC,aAAT;;;;"}